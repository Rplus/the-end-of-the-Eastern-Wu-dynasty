<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>吳末傳</title>
<!-- <link rel="stylesheet" href="normalize.css"> -->
<style>
body{
  margin: 0;
  color: #333;
}
ul{
  list-style: none;
}
li.name{
  background-repeat: no-repeat;
  padding-left: 130px;
  min-height: 120px;
  margin-bottom: 30px;
}
blockquote{
  margin: 10px;
  padding-left: 10px;
  color: #777;
  border-left: 4px solid #DDD;
}
h3{
  margin: 0 0 5px;
}
</style>
</head>
<body>
  <ul></ul>






















<!-- data build -->

<script>document.write('<script src="' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0/zepto.min.js' :  'http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js') + '"><\/script>');</script>

<script type="text/people-temp" id="people-temp">
  <li class="name" style="background-image: url(http://dl.dropboxusercontent.com/u/187714845/wu/{$人名}.png);">
    <h3>{$人名}</h3> - {$所屬方} - {$職業}
    <blockquote>{$名言}</blockquote>
    <div>{$註}</div>
    </li>
</script>
<script>
  var tpl = document.getElementById('people-temp').innerText,
  html = '';

  $.ajax({
    url: 'https://spreadsheets.google.com/feeds/list/0AqMUl4JFkRfldFRZbkk2YlBJVFVJQjYwZ1hoV2tQWHc/od6/public/values?alt=json',
    type: 'POST',
    dataType: 'jsonp',
    // complete: function (xhr, textStatus) {
    //   //called when complete
    // },
    success: function (data, textStatus, xhr) {
      var i, max,
          dd = data.feed.entry;
      max = dd.length;
      var xo = ['人名', '所屬方', '職業', '名言', '註'],
          arr = [];

      for (i = 0; i < max; i++) {
        var _obj = {};
        var _tpl = tpl;
        for(var j=0; j < xo.length; j++) {
          var _pattern = new RegExp('{\\$' + xo[j] + '}', 'g');
          _tpl = _tpl.replace(_pattern, dd[i]['gsx$'+xo[j]].$t);
        }
        html += _tpl;
      }
      $('body ul').html(html);
    },
    error: function (xhr, textStatus, errorThrown) {
      //called when there is an error
    }
  });
</script>
</body>
</html>